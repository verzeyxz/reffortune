/* --- THEME & BACKGROUND --- */
body {
    font-family: 'Noto Sans Thai', sans-serif;
    background-color: #100a33;
    color: white;
    overflow-x: hidden;
}
.space-bg {
    background: radial-gradient(ellipse at bottom, #0f0755 0%, #100a33 100%);
}
.stars, .twinkling, .planet { position: fixed; top: 0; left: 0; right: 0; bottom: 0; }
.stars { background: transparent url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/1231630/stars.png) repeat top center; z-index: -3; }
.twinkling { background: transparent url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/1231630/stars.png) repeat top center; z-index: -2; animation: move-twinkle-back 200s linear infinite; }
.planet { width: 300px; height: 300px; background: radial-gradient(circle at 30% 30%, #a29bfe, #6c5ce77a, #2c2d84); border-radius: 50%; box-shadow: 0 0 40px #6c5ce77c, 0 0 80px #a29bfe, inset -20px -10px 40px #352c84; animation: pulse 6s infinite ease-in-out; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: -1; }
@keyframes move-twinkle-back { from { background-position: 0 0; } to { background-position: -10000px 5000px; } }
@keyframes pulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.05); } }
.text-glow { text-shadow: 0 0 8px rgba(192, 132, 252, 0.6), 0 0 32px rgba(139, 92, 246, 0.4); }
.glass-box { background: rgba(141, 133, 172, 0.2); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); border-radius: 1rem; border: 1px solid rgba(255, 255, 255, 0.1); }

/* --- LAYOUT --- */
.main-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
    position: relative;
    z-index: 10;
}

/* ================== UPDATED STYLES FOR CONTROLS ================== */
.controls-container {
    position: sticky;
    top: 1rem;
    z-index: 20;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1.5rem;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    border-radius: 1rem; /* ทำให้ขอบมนสวยงาม */
}
.selection-tray-container {
    position: relative;
    display: flex;
    align-items: center;
    height: 80px; /* เพิ่มความสูงของถาด */
    flex-grow: 1;
}
.tray-card {
    position: absolute;
    width: 54px; /* เพิ่มขนาดไพ่จิ๋ว */
    aspect-ratio: 2/3;
    background-image: url(https://z262998-h64m7.ls01.zwhhosting.com/card/Sp.png);
    background-size: cover;
    border-radius: 5px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    border: 2px solid #A78BFA; /* เพิ่มขอบสีม่วง */
    filter: drop-shadow(0 0 5px rgba(167, 139, 250, 0.5)); /* เพิ่ม Glow */
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    opacity: 0;
    transform: translateY(20px);
}
.tray-card.in-tray {
    opacity: 1;
    transform: translateY(0);
}
.tray-card:hover {
    transform: translateY(-8px) scale(1.1);
    z-index: 100; /* ให้ไพ่ที่ hover อยู่บนสุดเสมอ */
}
.counter-text {
    font-size: 1.25rem;
    font-weight: bold;
    color: #E9D5FF;
    white-space: nowrap; /* ป้องกันการตัดคำ */
}
.confirm-btn {
    background-color: #8B5CF6;
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 9999px;
    font-weight: bold;
    border: none;
    transition: all 0.3s ease;
    white-space: nowrap;
}
.confirm-btn:hover:not(:disabled) {
    background-color: #A78BFA;
    transform: scale(1.05);
}
.confirm-btn:disabled {
    background-color: #374151; /* สีเทาเข้ม */
    cursor: not-allowed;
    opacity: 0.6;
}
/* NEW: Pulse animation for ready button */
.confirm-btn.ready {
    animation: pulse-glow 2s infinite;
}
@keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 15px rgba(167, 139, 250, 0); }
    50% { box-shadow: 0 0 20px rgba(196, 181, 253, 0.7); }
}

/* =================================================================== */


/* --- CARD GRID & STYLES --- */
.card-grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 1rem;
    perspective: 1000px;
}
.card-container {
    cursor: pointer;
    transition: transform 0.3s ease;
}
.card-container:hover {
    transform: scale(1.05);
}
.card-back {
    width: 100%;
    aspect-ratio: 2/3;
    background-image: url(https://z262998-h64m7.ls01.zwhhosting.com/card/Sp.png);
    background-size: cover;
    border-radius: 8px;
    border: 2px solid transparent;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.card-container.selected .card-back {
    border-color: #C4B5FD;
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 10px 20px rgba(196, 181, 253, 0.5);
    opacity: 0.7;
}

/* --- RESULTS SCREEN & MODAL STYLES --- */
#results-screen { background: rgba(15, 7, 85, 0.5); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 1rem; padding: 2rem; backdrop-filter: blur(5px); }
.results-grid-container { display: grid; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(2, auto); gap: 1.5rem; max-width: 1000px; margin: 0 auto; }
.result-card { text-align: center; animation: fadeIn 0.5s ease-out forwards; cursor: pointer; transition: transform 0.3s ease; }
.result-card:hover { transform: scale(1.07); }
@keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.result-card img { width: 100%; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.4); }
.result-card p { margin-top: 0.75rem; font-weight: bold; color: #E9D5FF; font-size: 0.875rem; }
.save-btn { background-color: #10B981; color: white; padding: 0.75rem 1.5rem; border-radius: 9999px; font-weight: bold; border: none; transition: all 0.3s ease; }
.save-btn:hover { background-color: #34D399; transform: scale(1.05); }
#card-modal-container.visible { opacity: 1; pointer-events: auto; }
#card-modal-container.visible #card-modal-panel { transform: scale(1); }

/* --- RESPONSIVE --- */
@media (max-width: 768px) {
    .controls-container {
        flex-direction: column;
        gap: 1rem;
        padding: 1rem;
    }
    .selection-tray-container {
        width: 100%;
        justify-content: center;
    }
}
@media (max-width: 640px) {
    .card-grid-container { grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); gap: 0.75rem; }
    .results-grid-container { gap: 0.75rem; grid-template-columns: repeat(5, 1fr); grid-template-rows: auto; } /* ปรับเป็น 5 คอลัมน์บนมือถือ */
    .result-card p { font-size: 0.7rem; margin-top: 0.5rem; }
}
